(function(n){n(["jquery","abp-web-resources"],function(n,t){return function(){if(n&&t){t.ajax=function(i){i=i||{};var r=n.extend(!0,{},t.ajax.defaultOpts,i),u=r.beforeSend;return r.beforeSend=function(n,t){u&&u(n,t);n.setRequestHeader("Pragma","no-cache");n.setRequestHeader("Cache-Control","no-cache");n.setRequestHeader("Expires","Sat, 01 Jan 2000 00:00:00 GMT")},r.success=undefined,r.error=undefined,n.Deferred(function(u){n.ajax(r).done(function(n,r,f){n.__abp?t.ajax.handleResponse(n,i,u,f):(u.resolve(n),i.success&&i.success(n))}).fail(function(n){n.responseJSON&&n.responseJSON.__abp?t.ajax.handleResponse(n.responseJSON,i,u,n):t.ajax.handleNonAbpErrorResponse(n,i,u)})})};n.extend(t.ajax,{defaultOpts:{dataType:"json",type:"POST",contentType:"application/json",headers:{"X-Requested-With":"XMLHttpRequest"}},defaultError:{message:"An error has occurred!",details:"Error detail not sent by server."},defaultError401:{message:"You are not authenticated!",details:"You should be authenticated (sign in) in order to perform this operation."},defaultError403:{message:"You are not authorized!",details:"You are not allowed to perform this operation."},defaultError404:{message:"Resource not found!",details:"The resource requested could not found on the server."},logError:function(n){t.log.error(n)},showError:function(n){return n.details?t.message.error(n.details,n.message):t.message.error(n.message||t.ajax.defaultError.message)},handleTargetUrl:function(n){location.href=n?n:t.appPath},handleNonAbpErrorResponse:function(n,i,r){if(i.abpHandleError!==!1)switch(n.status){case 401:t.ajax.handleUnAuthorizedRequest(t.ajax.showError(t.ajax.defaultError401),t.appPath);break;case 403:t.ajax.showError(t.ajax.defaultError403);break;case 404:t.ajax.showError(t.ajax.defaultError404);break;default:t.ajax.showError(t.ajax.defaultError)}r.reject.apply(this,arguments);i.error&&i.error.apply(this,arguments)},handleUnAuthorizedRequest:function(n,i){n?n.done(function(){t.ajax.handleTargetUrl(i)}):t.ajax.handleTargetUrl(i)},handleResponse:function(n,i,r,u){if(n)if(n.success===!0)r&&r.resolve(n.result,n,u),i.success&&i.success(n.result,n,u),n.targetUrl&&t.ajax.handleTargetUrl(n.targetUrl);else if(n.success===!1){var f=null;n.error?i.abpHandleError!==!1&&(f=t.ajax.showError(n.error)):n.error=t.ajax.defaultError;t.ajax.logError(n.error);r&&r.reject(n.error,u);i.error&&i.error(n.error,u);u.status===401&&i.abpHandleError!==!1&&t.ajax.handleUnAuthorizedRequest(f,n.targetUrl)}else r&&r.resolve(n,null,u),i.success&&i.success(n,null,u);else r&&r.resolve(u),i.success&&i.success(u)},blockUI:function(n){n.blockUI&&(n.blockUI===!0?t.ui.setBusy():t.ui.setBusy(n.blockUI))},unblockUI:function(n){n.blockUI&&(n.blockUI===!0?t.ui.clearBusy():t.ui.clearBusy(n.blockUI))},ajaxSendHandler:function(n,i,r){var u=t.security.antiForgery.getToken();u&&t.security.antiForgery.shouldSendToken(r)&&(r.headers&&r.headers[t.security.antiForgery.tokenHeaderName]!==undefined||i.setRequestHeader(t.security.antiForgery.tokenHeaderName,u))}});n(document).ajaxSend(function(n,i,r){return t.ajax.ajaxSendHandler(n,i,r)});n.fn.ajaxForm&&(n.fn.abpAjaxForm=function(i){i=i||{};var r=n.extend({},n.fn.abpAjaxForm.defaults,i);return r.beforeSubmit=function(){t.ajax.blockUI(r);i.beforeSubmit&&i.beforeSubmit.apply(this,arguments)},r.success=function(n){t.ajax.handleResponse(n,i)},r.complete=function(){t.ajax.unblockUI(r);i.complete&&i.complete.apply(this,arguments)},this.ajaxForm(r)},n.fn.abpAjaxForm.defaults={method:"POST"});t.event.on("abp.dynamicScriptsInitialized",function(){t.ajax.defaultError.message=t.localization.abpWeb("DefaultError");t.ajax.defaultError.details=t.localization.abpWeb("DefaultErrorDetail");t.ajax.defaultError401.message=t.localization.abpWeb("DefaultError401");t.ajax.defaultError401.details=t.localization.abpWeb("DefaultErrorDetail401");t.ajax.defaultError403.message=t.localization.abpWeb("DefaultError403");t.ajax.defaultError403.details=t.localization.abpWeb("DefaultErrorDetail403");t.ajax.defaultError404.message=t.localization.abpWeb("DefaultError404");t.ajax.defaultError404.details=t.localization.abpWeb("DefaultErrorDetail404")});return t}}()})})(typeof define=="function"&&define.amd?define:function(n,t){typeof module!="undefined"&&module.exports?module.exports=t(require("jquery"),require("abp-web-resources")):window.abp=t(window.jQuery,window.abp)});